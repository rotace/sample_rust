# 太陽光発電シミュレーション
日射量、気温、消費電力量の履歴から、発電量、電力収支、電力料金のシミュレーションを行うツール。

## 気象データ
* [気象庁 過去の気象データダウンロード](https://www.data.jma.go.jp/risk/obsdl/index.php)

上記リンク先の気象データベースからダウンロードしたCSVファイルにの以下のデータに対応。

* 気温 [℃]
* 相対湿度 [%]
* 蒸気圧 [hPa]
* 露点温度 [℃]

## 日射量データ
* [日射量データベース閲覧システム](https://appww2.infoc.nedo.go.jp/appww/index.html)

上記リンク先の年間時別日射量データベースからダウンロードしたCSVファイルの以下のデータに対応。

* 傾斜面日射量 [kWh/m2/hour]

## 消費電力量データ
* [Club TOHOGAS](https://members.tohogas.co.jp/)

上記リンク先の契約消費電力量データベースからダウンロードしたCSVファイルにの以下のデータに対応。

* 消費電力量 [kWh/hour]

## 発電量
* [JISC8907:2005 太陽光発電システムの発電電力量推定方法](https://kikakurui.com/c8/C8907-2005-01.html)
* [太陽光発電の発電量はどのくらい？計算方法をご紹介](https://blog.eco-megane.jp/estimate-amount-of-power-produced/)

上記リンク先の資料をもとに計算式を構築。

* 標準試験条件における太陽電池モジュール出力 PMS [kW]
* 標準試験条件における太陽電池出力 PAS [kW] `PAS = PMS x n`
* 標準試験条件における日照強度 SS [kW/m2]
* 太陽電池出力 P [m2] `P = PAS [kW] / SS [kW/m2]`
* 傾斜面日射量 HS [kWh/m2/hour]
* 設計係数 K [-] `K = 0.5～0.6`
* 発電量 Epm [kWh/hour] `Epm = P [m2] x HS [kWh/m2/hour] x K`

## 電力収支

* 消費電力量 [kWh/hour]
* 発電量 [kWh/hour] `Epm = P [m2] x HS [kWh/m2/hour] x K`
* 電力収支 [kWh/hour] ：（発電量）ー（消費電力量）
* 余剰電力量 [kWh/day] ：正の電力収支の日別積算値
* 不足電力量 [kWh/day] ：負の電力収支の日別積算値
* （発電量）ー（消費電力量）ー（余剰電力量）＋（不足電力量）＝０

## 蓄電池モデル

* 日別蓄電量 [kWh/day] ：蓄電池公称容量、余剰電力量、不足電力量のいずれか最小値
  * （蓄電池公称容量）≧（蓄電量）：蓄電量は蓄電池の容量以下
  * （余剰電力量）≧（蓄電量）：充電できるのは余剰電力量以下
  * （不足電力量）≧（蓄電量）：放電できるのは不足電力量以下
  * なお、実際には（不足電力量）＜（蓄電量）となりうるが、翌日の蓄電量が減り売電に回される。
  * よって、上記制約をつけても売電量の月別積算値、蓄電量の月別積算値は変わらないと仮定した。

## 買電量モデル

* 日別買電量 [kWh/day]
  * 不足電力量から日別蓄電量を除いた値とする

## 売電量モデル

* 日別売電量 [kWh/day]
  * 余剰電力量から日別蓄電量を除いた値とする

## 電力料金モデル

* 基本料金 (1400円)
* 電力量料金単価 (32円/kWh)
* 月別買電量 [kWh/month]
* 電力購入価格モデル 32円 x 購入量[kWh] + 1400円

## 初期費用モデル

* 太陽電池出力 [kW]
* 工事足場代 (60万円)
* 太陽電池出力単価 (25万円/kW)
* 太陽電池価格モデル 25万円 x 出力[kW] + 60万円
* 蓄電池公称容量 [kWh]
* 蓄電池初期価格 (100万円)
* 蓄電池公称容量単価 (10万円/kW)
* 蓄電池価格モデル 10万円 x 容量[kWh] + 100万円

## 回収年数モデル

* 初期費用 [円]
* 買電価格 [円] : 買電量[kWh] x 32円
* 買電価格 [円] : 売電量[kWh] x 24円(1～4年) OR x 8円(5年以降)
* 回収年数 [年] : (初期費用[円] - 64円 x 売電量[kWh]) / (32円 x (消費電力量[kWh] - 買電量[kWh]) + 8円 x 売電量[kWh])

